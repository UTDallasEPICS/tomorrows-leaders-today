generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model ApplicationRequirements {
  requirement_id Int     @id @default(autoincrement())
  grant_id       Int
  eligibility    String?
  materials      String?
  instructions   String?
  notes          String?
  Grants         Grants  @relation(fields: [grant_id], references: [grant_id], onDelete: Cascade, onUpdate: NoAction)
}

model Contacts {
  contact_id   Int     @id @default(autoincrement())
  grant_id     Int
  contact_type String?
  contact_info String?
  availability String?
  Grants       Grants  @relation(fields: [grant_id], references: [grant_id], onDelete: Cascade, onUpdate: NoAction)
}

model FundingOpportunities {
  funding_id           Int            @id @default(autoincrement())
  name                 String
  description          String?
  source               String?
  total_funding_amount Float?
  max_award_amount     Float?
  application_deadline DateTime?
  website              String?
  created_at           DateTime?      @default(now())
  updated_at           DateTime?      @default(now())
  GrantFunding         GrantFunding[]
}

model GrantCategories {
  category_id     Int      @id @default(autoincrement())
  name            String
  description     String?
  definition_link String?
  Grants          Grants[]
}

model GrantFunding {
  grant_id             Int
  funding_id           Int
  FundingOpportunities FundingOpportunities @relation(fields: [funding_id], references: [funding_id], onDelete: Cascade, onUpdate: NoAction)
  Grants               Grants               @relation(fields: [grant_id], references: [grant_id], onDelete: Cascade, onUpdate: NoAction)

  @@id([grant_id, funding_id])
}

model GrantStipulations {
  stipulation_id Int     @id @default(autoincrement())
  grant_id       Int
  condition      String?
  notes          String?
  Grants         Grants  @relation(fields: [grant_id], references: [grant_id], onDelete: Cascade, onUpdate: NoAction)
}

model GrantTimelines {
  timeline_id Int      @id @default(autoincrement())
  grant_id    Int
  event_type  String
  event_date  DateTime
  details     String?
  Grants      Grants   @relation(fields: [grant_id], references: [grant_id], onDelete: Cascade, onUpdate: NoAction)
}

model Grants {
  grant_id                Int                       @id @default(autoincrement())
  title                   String
  description             String?
  category_id             Int?
  status                  String?
  website                 String?
  award_details           String?
  interview_required      Int?                      @default(0)
  rolling_basis           Int?                      @default(0)
  created_at              DateTime?                 @default(now())
  updated_at              DateTime?                 @default(now())
  ApplicationRequirements ApplicationRequirements[]
  Contacts                Contacts[]
  GrantFunding            GrantFunding[]
  GrantStipulations       GrantStipulations[]
  GrantTimelines          GrantTimelines[]
  GrantCategories         GrantCategories?          @relation(fields: [category_id], references: [category_id], onUpdate: NoAction)
}

model GrantCategory {
  id          Int      @id @default(autoincrement())
  name        String   @db.VarChar(100)
  description String?
  definitionLink String?
  grants      Grant[]
}

model Grant {
  id                Int      @id @default(autoincrement())
  title             String   @db.VarChar(255)
  description       String?
  categoryId        Int?
  category          GrantCategory? @relation(fields: [categoryId], references: [id])
  status            String?  @db.VarChar(50)
  website           String?  @db.VarChar(255)
  awardDetails      String?
  interviewRequired Boolean  @default(false)
  rollingBasis      Boolean  @default(false)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  timelines         GrantTimeline[]
  requirements      ApplicationRequirement[]
  contacts          Contact[]
  stipulations      GrantStipulation[]
  funding           GrantFunding[]
}

model GrantTimeline {
  id        Int      @id @default(autoincrement())
  grantId   Int
  grant     Grant    @relation(fields: [grantId], references: [id], onDelete: Cascade)
  eventType String   @db.VarChar(100)
  eventDate DateTime
  details   String?
}

model ApplicationRequirement {
  id           Int      @id @default(autoincrement())
  grantId      Int
  grant        Grant    @relation(fields: [grantId], references: [id], onDelete: Cascade)
  eligibility  String?
  materials    String?
  instructions String?
  notes        String?
}

model Contact {
  id           Int      @id @default(autoincrement())
  grantId      Int
  grant        Grant    @relation(fields: [grantId], references: [id], onDelete: Cascade)
  contactType  String?  @db.VarChar(50)
  contactInfo  String?  @db.VarChar(255)
  availability String?  @db.VarChar(100)
}

model GrantStipulation {
  id        Int      @id @default(autoincrement())
  grantId   Int
  grant     Grant    @relation(fields: [grantId], references: [id], onDelete: Cascade)
  condition String?
  notes     String?
}

model FundingOpportunity {
  id                  Int      @id @default(autoincrement())
  name                String   @db.VarChar(255)
  description         String?
  source              String?  @db.VarChar(255)
  totalFundingAmount  Decimal? @db.Decimal(15, 2)
  maxAwardAmount      Decimal? @db.Decimal(15, 2)
  applicationDeadline DateTime?
  website             String?  @db.VarChar(255)
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
  grants              GrantFunding[]
}

model GrantFunding {
  grantId              Int
  fundingId            Int
  grant                Grant               @relation(fields: [grantId], references: [id], onDelete: Cascade)
  fundingOpportunity   FundingOpportunity  @relation(fields: [fundingId], references: [id], onDelete: Cascade)

  @@id([grantId, fundingId])
}
